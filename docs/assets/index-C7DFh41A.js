(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const t of e.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&r(t)}).observe(document,{childList:!0,subtree:!0});function d(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(n){if(n.ep)return;n.ep=!0;const e=d(n);fetch(n.href,e)}})();console.log("Doctiplay Presentation Initialized");function L(){const o=document.getElementById("main"),a=document.getElementById("indicator");o&&a&&o.addEventListener("scroll",()=>{const t=o.scrollTop,i=o.scrollHeight-o.clientHeight,s=i>0?t/i*100:0;a.style.height=s+"%"});const d=document.querySelectorAll(".reveal"),r=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting&&i.target.classList.add("active")})},{threshold:.1});d.forEach(t=>r.observe(t)),document.querySelectorAll("#slide-1 .reveal").forEach(t=>{t.classList.add("active")}),o&&window.addEventListener("keydown",t=>{const i=o.clientHeight;(t.key==="ArrowDown"||t.key==="PageDown")&&(t.preventDefault(),o.scrollBy({top:i,left:0,behavior:"smooth"})),(t.key==="ArrowUp"||t.key==="PageUp")&&(t.preventDefault(),o.scrollBy({top:-i,left:0,behavior:"smooth"}))}),document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",i=>{const s=t.getAttribute("href"),c=document.querySelector(s);c&&o&&(i.preventDefault(),c.scrollIntoView({behavior:"smooth"}))})});const e=document.getElementById("pdf-export-btn");e&&e.addEventListener("click",()=>{document.querySelectorAll(".reveal").forEach(i=>i.classList.add("active")),setTimeout(()=>{window.print()},300)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{L(),P()}):(L(),setTimeout(P,100));const l={fc:90,spo2:99,nibpSys:100,nibpDia:60,targetFc:90,targetSpo2:99,targetNibpSys:100,targetNibpDia:60};window.scopeAction=function(o){const a=document.querySelectorAll(".scope-toast"),r=new Date().toLocaleTimeString("fr-FR");let n="";if(o==="o2"){l.targetSpo2=98,n="O₂ administré";let e=l.spo2>95?95:l.spo2;I(".val-spo2",e,98,2e3),l.spo2=98}else o==="remplissage"?(l.targetNibpSys=110,l.targetNibpDia=70,n="Remplissage initié",x(l.nibpSys,l.nibpDia,110,70),l.nibpSys=110,l.nibpDia=70):o==="insuline"&&(l.targetFc=85,n="Insulinothérapie débutée",I(".val-fc",l.fc,85,2e3),l.fc=85);a.forEach(e=>{e.innerText=`[${r}] ${n}`,e.classList.add("show"),setTimeout(()=>e.classList.remove("show"),3e3)})};function I(o,a,d,r,n){const e=document.querySelectorAll(o);if(e.length===0)return;e.forEach(u=>{u.classList.add("pulse-anim"),setTimeout(()=>u.classList.remove("pulse-anim"),300)});const t=d-a;let i=a;const s=d>a?1:-1,c=Math.abs(Math.floor(r/(t===0?1:t)));if(t===0)return;const f=setInterval(function(){i+=s,e.forEach(u=>u.innerText=i),i==d&&clearInterval(f)},Math.max(c,50))}function x(o,a,d,r){const n=document.querySelectorAll(".val-nibp");if(n.length===0)return;n.forEach(s=>{s.classList.add("pulse-anim"),setTimeout(()=>s.classList.remove("pulse-anim"),300)});let e=o,t=a;const i=setInterval(()=>{let s=!1;e!=d&&(e+=e<d?1:-1,s=!0),t!=r&&e%2===0&&(t+=t<r?1:-1,s=!0),n.forEach(c=>c.innerText=`${e}/${t}`),s||clearInterval(i)},100)}function P(){const o=document.querySelectorAll(".live-monitor");if(o.length===0){setTimeout(P,500);return}o.forEach(r=>{const n=r.querySelector(".ecg-canvas"),e=r.querySelector(".pleth-canvas");if(!n||!e)return;function t(){const h=n.parentElement,m=e.parentElement,g=h.getBoundingClientRect(),y=m.getBoundingClientRect(),v=g.width||h.clientWidth,p=g.height||h.clientHeight,E=y.width||m.clientWidth,b=y.height||m.clientHeight;v>0&&p>0&&(n.width=v,n.height=p),E>0&&b>0&&(e.width=E,e.height=b)}t(),setTimeout(t,100),setTimeout(t,1e3),window.addEventListener("resize",t);const i=n.getContext("2d"),s=e.getContext("2d");let c=0,f=1.4;function u(){const h=n.height,m=h/2+25,g=e.height,y=g/2+15,v=14;c+v<n.width&&(i.clearRect(c,0,v,h),s.clearRect(c,0,v,g));const p=20;i.beginPath(),i.strokeStyle="#00ff00",i.lineWidth=1.5;const E=m+a((c-f)*p),b=m+a(c*p);i.moveTo(c-f,E),i.lineTo(c,b),i.stroke(),s.beginPath(),s.strokeStyle="#00ffff",s.lineWidth=1.5;const q=y+d((c-f)*p),M=y+d(c*p);s.moveTo(c-f,q),s.lineTo(c,M),s.stroke(),c+=f,c>=n.width&&(c=0,i.clearRect(0,0,f+10,h),s.clearRect(0,0,f+10,g));const S=r.querySelector(".val-fc"),w=r.querySelector(".val-spo2"),T=r.querySelector(".val-nibp");S&&S.innerText!=l.fc&&(S.innerText=l.fc),w&&w.innerText!=l.spo2&&(w.innerText=l.spo2),T&&T.innerText!=`${l.nibpSys}/${l.nibpDia}`&&(T.innerText=`${l.nibpSys}/${l.nibpDia}`),requestAnimationFrame(u)}requestAnimationFrame(u)});function a(r){const e=r%800;let t=0;return e>180&&e<210&&(t-=90*Math.sin((e-180)/30*Math.PI)),e>300&&e<450&&(t-=12*Math.sin((e-300)/150*Math.PI)),e>50&&e<150&&(t-=4*Math.sin((e-50)/100*Math.PI)),t}function d(r){const e=r%800;let t=0;return e<300?t-=Math.sin(e/300*Math.PI)*45:t-=Math.cos((e-300)/500*Math.PI/2)*45,t}}
