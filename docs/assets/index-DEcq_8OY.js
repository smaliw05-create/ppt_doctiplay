(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const t of e.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&s(t)}).observe(document,{childList:!0,subtree:!0});function d(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(n){if(n.ep)return;n.ep=!0;const e=d(n);fetch(n.href,e)}})();console.log("Doctiplay Presentation Initialized");function L(){const i=document.getElementById("main"),r=document.getElementById("indicator");i&&r&&i.addEventListener("scroll",()=>{const t=i.scrollTop,o=i.scrollHeight-i.clientHeight,c=o>0?t/o*100:0;r.style.height=c+"%"});const d=document.querySelectorAll(".reveal"),s=new IntersectionObserver(t=>{t.forEach(o=>{o.isIntersecting&&o.target.classList.add("active")})},{threshold:.1});d.forEach(t=>s.observe(t)),document.querySelectorAll("#slide-1 .reveal").forEach(t=>{t.classList.add("active")}),i&&window.addEventListener("keydown",t=>{const o=i.clientHeight;(t.key==="ArrowDown"||t.key==="PageDown")&&(t.preventDefault(),i.scrollBy({top:o,left:0,behavior:"smooth"})),(t.key==="ArrowUp"||t.key==="PageUp")&&(t.preventDefault(),i.scrollBy({top:-o,left:0,behavior:"smooth"}))}),document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",o=>{const c=t.getAttribute("href"),l=document.querySelector(c);l&&i&&(o.preventDefault(),l.scrollIntoView({behavior:"smooth"}))})});const e=document.getElementById("pdf-export-btn");e&&e.addEventListener("click",()=>{document.querySelectorAll(".reveal").forEach(o=>o.classList.add("active")),setTimeout(()=>{window.print()},300)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{L(),P(),I()}):(L(),setTimeout(P,100),setTimeout(I,100));function I(){const i=document.querySelectorAll(".timer-countdown");if(i.length===0)return;let r=900;setInterval(()=>{r--,r<0&&(r=900);const d=Math.floor(r/60),s=r%60,n=`${d}:${s.toString().padStart(2,"0")}`;i.forEach(e=>e.innerText=n)},1e3)}const a={fc:90,spo2:99,nibpSys:100,nibpDia:60,targetFc:90,targetSpo2:99,targetNibpSys:100,targetNibpDia:60};window.scopeAction=function(i){const r=document.querySelectorAll(".scope-toast"),s=new Date().toLocaleTimeString("fr-FR");let n="";if(i==="o2"){a.targetSpo2=98,n="O₂ administré";let e=a.spo2>95?95:a.spo2;q(".val-spo2",e,98,2e3),a.spo2=98}else i==="remplissage"?(a.targetNibpSys=110,a.targetNibpDia=70,n="Remplissage initié",A(a.nibpSys,a.nibpDia,110,70),a.nibpSys=110,a.nibpDia=70):i==="insuline"&&(a.targetFc=85,n="Insulinothérapie débutée",q(".val-fc",a.fc,85,2e3),a.fc=85);r.forEach(e=>{e.innerText=`[${s}] ${n}`,e.classList.add("show"),setTimeout(()=>e.classList.remove("show"),3e3)})};function q(i,r,d,s,n){const e=document.querySelectorAll(i);if(e.length===0)return;e.forEach(u=>{u.classList.add("pulse-anim"),setTimeout(()=>u.classList.remove("pulse-anim"),300)});const t=d-r;let o=r;const c=d>r?1:-1,l=Math.abs(Math.floor(s/(t===0?1:t)));if(t===0)return;const f=setInterval(function(){o+=c,e.forEach(u=>u.innerText=o),o==d&&clearInterval(f)},Math.max(l,50))}function A(i,r,d,s){const n=document.querySelectorAll(".val-nibp");if(n.length===0)return;n.forEach(c=>{c.classList.add("pulse-anim"),setTimeout(()=>c.classList.remove("pulse-anim"),300)});let e=i,t=r;const o=setInterval(()=>{let c=!1;e!=d&&(e+=e<d?1:-1,c=!0),t!=s&&e%2===0&&(t+=t<s?1:-1,c=!0),n.forEach(l=>l.innerText=`${e}/${t}`),c||clearInterval(o)},100)}function P(){const i=document.querySelectorAll(".live-monitor");if(i.length===0){setTimeout(P,500);return}i.forEach(s=>{const n=s.querySelector(".ecg-canvas"),e=s.querySelector(".pleth-canvas");if(!n||!e)return;function t(){const h=n.parentElement,m=e.parentElement,g=h.getBoundingClientRect(),y=m.getBoundingClientRect(),v=g.width||h.clientWidth,p=g.height||h.clientHeight,E=y.width||m.clientWidth,S=y.height||m.clientHeight;v>0&&p>0&&(n.width=v,n.height=p),E>0&&S>0&&(e.width=E,e.height=S)}t(),setTimeout(t,100),setTimeout(t,1e3),window.addEventListener("resize",t);const o=n.getContext("2d"),c=e.getContext("2d");let l=0,f=1.4;function u(){const h=n.height,m=h/2+25,g=e.height,y=g/2+15,v=14;l+v<n.width&&(o.clearRect(l,0,v,h),c.clearRect(l,0,v,g));const p=20;o.beginPath(),o.strokeStyle="#00ff00",o.lineWidth=1.5;const E=m+r((l-f)*p),S=m+r(l*p);o.moveTo(l-f,E),o.lineTo(l,S),o.stroke(),c.beginPath(),c.strokeStyle="#00ffff",c.lineWidth=1.5;const M=y+d((l-f)*p),x=y+d(l*p);c.moveTo(l-f,M),c.lineTo(l,x),c.stroke(),l+=f,l>=n.width&&(l=0,o.clearRect(0,0,f+10,h),c.clearRect(0,0,f+10,g));const b=s.querySelector(".val-fc"),w=s.querySelector(".val-spo2"),T=s.querySelector(".val-nibp");b&&b.innerText!=a.fc&&(b.innerText=a.fc),w&&w.innerText!=a.spo2&&(w.innerText=a.spo2),T&&T.innerText!=`${a.nibpSys}/${a.nibpDia}`&&(T.innerText=`${a.nibpSys}/${a.nibpDia}`),requestAnimationFrame(u)}requestAnimationFrame(u)});function r(s){const e=s%800;let t=0;return e>180&&e<210&&(t-=90*Math.sin((e-180)/30*Math.PI)),e>300&&e<450&&(t-=12*Math.sin((e-300)/150*Math.PI)),e>50&&e<150&&(t-=4*Math.sin((e-50)/100*Math.PI)),t}function d(s){const e=s%800;let t=0;return e<300?t-=Math.sin(e/300*Math.PI)*45:t-=Math.cos((e-300)/500*Math.PI/2)*45,t}}
